#!/usr/bin/env node

var shell = require('shelljs');
var glob = require('glob-fs')({ gitignore: true });
var log = require('console-emoji');

var args = process.argv.slice(2);

for (var i = 0; i < args.length; i++) {
  var files = glob.readdirSync(args[i] + ".less");

  for (var j = 0; j < files.length; j++) {
    var binDir = shell.exec('npm bin', { async: false, silent: true }).stdout;
    var bin = binDir.slice(0, -1) + '/lessc';
    var outputFile = files[j].replace('.less', '.css');

    var status = shell.exec(bin + ' ' + files[j] + ' ' + outputFile).code;
    if (status === 0) {
      log(':white_check_mark: ' + files[j], 'ok');
    } else {
      log(':x: ' + files[j], 'err');
    }
  }
}
